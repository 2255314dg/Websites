{% extends 'students/base.html' %}
{% load widget_tweaks %}

{% block title %}{% if form.instance.id %}编辑排课{% else %}添加排课{% endif %}{% endblock %}

{% block content %}
<div class="content-container">
    <h2>{% if form.instance.id %}编辑排课{% else %}添加排课{% endif %}</h2>
    <form method="post" class="data-form">
        {% csrf_token %}
        
        <div class="form-section">
            <h3>排课信息</h3>
            
            <div class="form-group">
                <label for="{{ form.course.id_for_label }}">课程:</label>
                {% render_field form.course class="form-control" %}
                {% if form.course.errors %}
                <div class="error-message">{{ form.course.errors }}</div>
                {% endif %}
            </div>
            
            <div class="form-group">
                <label for="{{ form.weekday.id_for_label }}">星期:</label>
                {% render_field form.weekday class="form-control" %}
                {% if form.weekday.errors %}
                <div class="error-message">{{ form.weekday.errors }}</div>
                {% endif %}
            </div>
            
            <div class="form-row">
                <div class="form-group col-md-6">
                    <label for="{{ form.start_time.id_for_label }}">开始时间:</label>
                    {% render_field form.start_time class="form-control timepicker" %}
                    {% if form.start_time.errors %}
                    <div class="error-message">{{ form.start_time.errors }}</div>
                    {% endif %}
                </div>
                
                <div class="form-group col-md-6">
                    <label for="{{ form.end_time.id_for_label }}">结束时间:</label>
                    {% render_field form.end_time class="form-control timepicker" %}
                    {% if form.end_time.errors %}
                    <div class="error-message">{{ form.end_time.errors }}</div>
                    {% endif %}
                </div>
            </div>
            
            <div class="form-group">
                <label for="{{ form.classroom.id_for_label }}">教室:</label>
                {% render_field form.classroom class="form-control" %}
                {% if form.classroom.errors %}
                <div class="error-message">{{ form.classroom.errors }}</div>
                {% endif %}
            </div>
        </div>
        
        <div class="form-actions">
            <button type="submit" class="btn submit-btn">保存</button>
            <a href="{% url 'schedule_list' %}" class="btn cancel-btn">取消</a>
            {% if form.instance.id %}
            <a href="{% url 'schedule_delete' form.instance.id %}" class="btn delete-btn" style="margin-left: auto;">删除</a>
            {% endif %}
        </div>
    </form>
</div>

<script>
    // 添加时间选择器支持
    document.addEventListener('DOMContentLoaded', function() {
        const timepickers = document.querySelectorAll('.timepicker');
        timepickers.forEach(picker => {
            picker.type = 'time';
            // 设置时间格式
            picker.step = 300; // 5分钟为间隔
        });
    });
</script>

<style>
    .form-row {
        display: flex;
        gap: 1rem;
        margin-bottom: 1rem;
    }
    
    .form-row .form-group {
        flex: 1;
        margin-bottom: 0;
    }
</style>
{% endblock %}